function histscatterplot(Z,nbins);% histscatterplot           - histograms and scatter plots (Jan 1,2001)%% Plot the histograms for a set of variables and the corresponding% scatterplots between variables.%% SYNTAX :%% histscatterplot(Z,nbins);%% INPUT : %% Z          n by nv matrix of values for the different variables, where%                    each column corresponds to the values of one variable.%                    There must be at least two variables.% nbins      scalar  number of bins to be used for drawing the histograms. If%                    nbins is omitted from the input list of variables, the %                    function will use the default number of bins as specified%                    in hist.m.%%% Initialize the parameters[n,nv]=size(Z);if nv==1,  error('The Z matrix should at least have two columns');end;narg=nargin;%%% display the histograms and scatter plotstest=(ishold==1);for i=1:nv,  for j=i:nv,    subplot(nv,nv,(i-1)*nv+j);    if i==j      if narg==1,        hist(Z(:,i));      else        hist(Z(:,i),nbins);      end;      set(gca,'FontSize',6);      title(['Variable ',num2str(i)],'FontSize',8);    else      plot(Z(:,i),Z(:,j),'.');      set(gca,'FontSize',6);      title(['Couple ',num2str(i),'-',num2str(j)'],'FontSize',8);    end;  end;end;if test==0,  hold off;end;