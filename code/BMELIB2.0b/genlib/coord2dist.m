function [D]=coord2dist(c1,c2);% coord2dist                - distance matrix from coordinates (Jan 1,2001)%% Computes the Euclidean distance matrix between two sets of coordinates.%% SYNTAX :%% [D]=coord2dist(c1,c2);%% INPUT :%% c1      n1 by d   matrix of coordinates for the locations in the first set.%                   A line corresponds to the vector of coordinates at a location,%                   so the number of columns is equal to the dimension of the space.%                   There is no restriction on the dimension of the space.% c2      n2 by d   matrix of coordinates for the locations in the second set, using%                   the same conventions as for c1. %% OUTPUT :%% D       n1 by n2  Euclidean distance matrix between the coordinates in c1 and c2.%                   The number of lines and columns for D corresponds to the number%                   of lines in c1 and the number of lines in c2, respectively.%% NOTE :%% It is possible to specify additional n1 by 1 and n2 by 1 index vectors, taking% integer values from 1 to nv. The values in the index vectors specify which one% of the nv variable is known at each one of the corresponding coordinates. The c1% and c2 matrices of coordinates and the index vectors are then grouped together% using the MATLAB cell array notation, so that c1={c1,index1} and c2={c2,index2}.isarray=iscell(c1);if isarray==1,  c1=c1{1};  c2=c2{1};end;n1=size(c1,1);n2=size(c2,1);unit1=ones(n1,1);unit2=ones(n2,1);D=kron(unit2,c1)-kron(c2,unit1);if size(D,2)==1,  D=abs(D);else  D=sqrt(sum((D.^2)')');end;D=reshape(D,n1,n2);