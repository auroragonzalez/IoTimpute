function [c1,c2,Z]=col2mat(c,z);% col2mat                   - columnwise defined gridded variable toward matrix (Jan 1,2001)%% Convert, e.g. the format of the data output from invdist.m and% kernelsmoothing.m, so that the converted data can be directly% displayed using graphical functions like mesh.m or pcolor.m. The% col2mat.m function converts a columnwise defined gridded variable% at a set of planar coordinates into a matrix of values and two% separate vectors of coordinates along each axis.%% SYNTAX :%% [c1,c2,Z]=col2mat(c,z);%% INPUT :%% c     n by 2    matrix of coordinates for the nodes of a rectangular grid%                 in a two dimensional space. Each line in c corresponds to%                 the coordinates of a grid node, so the number of columns is%                 equal to 2, and the number of lines n is equal to n1*n2,%                 where n1 and n2 are the number of columns and lines for the%                 rectangular grid, respectively.% z     n by 1    vector of values at the coordinates specified in c.%% OUTPUT :%% c1    n1 by 1   vector of coordinates for the grid nodes along the first axis.% c2    n2 by 1   vector of coordinates for the grid nodes along the second axis.% Z     n1 by n2  matrix of values that correspond to the values in z.%% NOTE :%% It is not needed that the values in c are sorted in ascending order, as% the function is taking care of it, but the coordinates for all the points% of the rectangular grid should appear once and only once in the c matrix.% There is no constraint about the regularity of the spacing for the nodes% of the grid along the axes, as long as the grid is rectangular.S=sortrows([c,z],[1 2]);        %%% sort jointly the coordinates and valuesn1=sum(S(1,1)==S(:,1));         %%% compute the number of columns in the gridn2=sum(S(1,2)==S(:,2));         %%% compute the number of lines in the gridZ=reshape(S(:,3),n1,n2);        %%% reshape the z vector accordinglyc1=reshape(S(:,1),n1,n2);       %%% extract the coordinates along the linesc1=c1(1,:)';c2=reshape(S(:,2),n1,n2);       %%% extract the coordinates along the columnsc2=c2(:,1);