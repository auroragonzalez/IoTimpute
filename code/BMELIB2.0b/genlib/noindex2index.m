function [c,z]=noindex2index(c,z);% noindex2index             - separated coordinates and variables toward grouped (Jan 1,2001)%% Convert a set of matrix of coordinates and vector of values% into a single cell array of coordinates and a single array% of values. The cell array of coordinates has as first cell % the grouped set of coordinates, and as second cell an index% vector with values ranging from 1 the number of input vector% of values.%% SYNTAX :%% [c,z]=noindex2index(c,z);%% INPUT :%% c    1 by nv   cell array, where each cell contains the ni by d matrix%                of coordinates for each of the nv variables, with ni the%                number of coordinates for the ith variable and d the dimension%                of the space. There is no restriction on the dimension of%                the space.% z    1 by nv   cell array, where each cell contains the column vector of%                values for one of the nv variables at the coordinates%                specified in c.%% OUTPUT :%% c    1 by 2    cell array, where the first cell is the vertical stacking%                of the matrices of coordinates in the input c variable, and%                the second cell is a vector of index values ranging from 1%                to nv. The n1 first index values are equal to 1, the following%                n2 index values are equal to 2, etc.% z    n by 1    vector that corresponds to a vertical stacking of the nv vector%                of values.%% NOTE :%% For example, if c1, c2 and c3 are the coordinates for the vector% of values z1, z2 and z3 having n1, n2 and n3 elements, respectively,% then%% [c,z]=noindex2index({c1,c2,c3},{z1,z2,z3});%% yield the output variables c and z such that%% c{1}=[c1;c2;c3];% c{2}=[1*ones(n1,1);2*ones(n2,1);3*ones(n3,1)];% z=[z1;z2;z3];ctemp=cell(1,2);ztemp=[];nv=length(c);for i=1:nv,  nic=size(c{i},1);  niz=size(z{i},1);  if nic~=niz,    error('Number of lines must correspond for the elements in the c and z cell arrays');  end;  ctemp{1}=[ctemp{1};c{i}];  ctemp{2}=[ctemp{2};i*ones(size(z{i}))];  ztemp=[ztemp;z{i}];end;c=ctemp;z=ztemp;