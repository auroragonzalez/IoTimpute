function [pdfzfile]=kerneldensity(z,zfile,v,w);% kerneldensity             - pdf estimation using a Gaussian kernel (Jan 1,2001)%% Implementation of the traditional kernel method for estimating% a nonparameteric univariate probability distribution function% from a set of values. The Gaussian kernel is used in this% function ; it is characterized by a smoothing parameter that% corresponds to the variance of the Gaussian distribution.%% SYNTAX :%% [pdfzfile]=kerneldensity(z,zfile,v,w);%%% INPUT :%% z         n by 1   vector of values.% zfile     nk by 1  vector of values for which the density must be estimated.% v         scalar   variance of the Gaussian kernel.% w         n by 1   optional column vector of weights for the z values.%                    These weights must be positive and must sum to one%                    (see, e.g., decluster.m above). If w is not specified,%                    all the weights are taken as equal.%% OUTPUT :%% pdfzfile  nk by 1  vector of estimated values for the kernel smoothed probability%                    distribution function computed at the zfile values. n=length(z);m=length(zfile);pdfzfile=zeros(m,1);if nargin<4,  w=ones(n,1)/n;end;for i=1:n,  pdfzfile=pdfzfile+w(i)*gausspdf(zfile,[z(i) v]);end;