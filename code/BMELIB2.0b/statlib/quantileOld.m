function [q]=quantile(z,pdf,p,method);% quantile                  - quantiles computed from the pdf  (Jan 1,2001)%% Compute the quantiles associated with probabilities based% on a discrete definition of a univariate probability% distribution function.%% SYNTAX :%% [q]=quantile(z,pdf,p,method);%% INPUT :%% z         n by 1   vector of values.% pdf       n by 1   vector of the probability distribution function values%                    at the z values.% p         m by k   matrix of probability values for which the quantiles%                    must be computed.% method    string   which is optional and specifies the interpolation%                    method to be used. See interp1.m for available methods.%                    Default value is 'linear'. %% OUTPUT :%% q         m by k   matrix of quantile values associated with the probabilities%                    specified in the p matrix.%% NOTE :%% The values of probabilities must lie inside the definition domain% of the cumulative distribution function obtained from the pdf% variable.if nargin<4,  method='linear';end;cdf=pdf2cdf(z,pdf);if (min(min(p))<min(cdf))|(max(max(p))>max(cdf)),  error('probability values must lie in the definition domain of the cdf');end;[z,index]=sort(z);cdf=cdf(index);[m,k]=size(p);q=zeros(m,k);if m<k,  for i=1:m,    q(i,:)=interp1(cdf,z,p(i,:),method);  end;else  for i=1:k,    q(:,i)=interp1(cdf,z,p(:,i),method);  end;end;