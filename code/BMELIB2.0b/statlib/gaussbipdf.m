function [pdf]=gaussbipdf(z1,z2,param);% gaussbipdf                - bivariate Gaussian probability distribution function (Jan 1,2001)%% Compute the values of the bivariate Gaussian probability% distribution function for a set of couples of values. %% SYNTAX :%% [pdf]=gaussbipdf(z1,z2,param);%% INPUT :%% z1       n by k   matrix of values for the first variable.% z2       n by k   matrix of values for the second variable, where each%                   element in z1 is associated with the corresponding%                   element in z2. Either z1 or z2 can be scalar. In such%                   a case, the corresponding variable is kept constant and%                   the output variable has the same size than the other matrix.% param    1 by 5   vector of parameters for the bivariate distribution, where :%                   param(1) and param(2) are the mean of the first and second%                   variables,%                   param(3) and param(4) are the variances of the first and second%                   variables,%                   param(5) is the correlation coefficient.%% OUTPUT :%% pdf      n by k   matrix of values for the probability distribution function%                   computed at the couples of values specified in z1 and z2.m1=param(1);m2=param(2);v1=param(3);v2=param(4);rho=param(5);z1c=(z1-m1)/sqrt(v1);z2c=(z2-m2)/sqrt(v2);if abs(rho)~=1,   K=1/(2*pi*sqrt(v1*v2)*sqrt(1-rho^2));  h=(1/(1-rho^2))*(z1c.^2-2*rho*z1c.*z2c+z2c.^2);  pdf=K*exp(-h/2);else  error('correlation coefficient cannot be equal to +/- 1');end;