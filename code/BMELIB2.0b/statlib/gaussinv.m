function [z]=gaussinv(p,param);% gaussinv                  - inverse Gaussian cumulative distribution function (Jan 1,2001)%% Compute the quantiles for a Gaussian distribution with% specified mean and variance parameters.%% SYNTAX :%% [z]=gaussinv(p,param);%% INPUT :%% p        n by k   matrix of values for the cumulative probabilities.% param    1 by 2   parameters of the Gaussian distribution, where :%                   param(1) is the mean of the distribution,%                   param(2) is the variance of the distribution.%% OUTPUT :%% z        n by k   matrix of quantile values computed at the%                   corresponding p values.%% NOTE :%% For values of p equal to 0 and 1, instead of the +/- Inf values,% the function returns the values param(1) +/- 8.3*sqrt(param(2)).m=param(1);v=param(2);if v<0,  error('a variance cannot be negative');end;if max(p(:))>1 | min(p(:))<0,  error('cumulative probability values must be inside [0,1]');end;z=sqrt(2)*erfinv(2*p-1);findisinf=find(isinf(z));signisinf=sign(z(findisinf));z(findisinf)=signisinf*8.3;z=z*sqrt(v)+m;