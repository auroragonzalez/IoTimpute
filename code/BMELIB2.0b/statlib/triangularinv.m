function [z]=triangularinv(p,param);% triangularinv             - inverse triangular cumulative distribution function (Jan 1,2001)%% Compute the quantiles for a triangular distribution with% specified lower bound, upper bound and mode parameters.%% SYNTAX :%% [z]=triangularinv(p,param);%% INPUT :%% p        n by k   matrix of values for the cumulative probabilities.% param    1 by 3   parameters of the triangular distribution, where :%                   param(1) is the lower bound of the distribution,%                   param(2) is the upper bound of the distribution,%                   param(3) is the mode of the distribution,%                   where param(1)<=param(3)<=param(2).%% OUTPUT :%% z        n by k   matrix of quantile values computed at the%                   corresponding p values.a=param(1);b=param(2);c=param(3);isvalid=((a<=b)&(c>=a)&(c<=b));if isvalid==0,  error('parameters are not valid');end;if max(p(:))>1 | min(p(:))<0,  error('cumulative probability values must be inside [0,1]');end;options=optimset('Display','off','TolX',1e-4,'MaxIter',500);[n,k]=size(p);z=zeros(n,k);for i=1:n,  for j=1:k,    z(i,j)=fminbnd(@fmintriangularinv,a,b,options,param,p(i,j));  end;end;