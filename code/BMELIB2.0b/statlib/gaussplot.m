function [zq,qgauss]=gaussplot(z,w);% gaussplot                 - Gaussian probability plot (Jan 1,2001)%% Plot values versus the corresponding quantiles of a zero% mean unit variance Gaussian distribution. Quantiles values% are obtained from an estimate of the cumulative distribution% function. For Gaussian distributed values, the graph should% appear close to a straigth line. %% SYNTAX :%% [zq,qgauss]=gaussplot(z,w); %% INPUT :%% z        n by 1   vector of values.% w        n by 1   optional vector of weights associated with the%                   values in z. These weights must be positive and%                   sum to one. If w is not specified, the weights are%                   all taken as equal. Weights may come, e.g., from a%                   declustering technique (see, e.g., decluster.m).%% OUTPUT :%% zq       m by 1   vector of sorted z values where the duplicate z values%                   have been removed (m<=n).% qgauss   m by 1   vector of the Gaussian quantile values associated with%                   the values in zq.%% NOTE :%% When output variables are specified, the graphic is not displayed and% gaussplot.m simply returns the values for these variables instead. if nargin<2,  [zq,cdfzq]=cdfest(z);else  [zq,cdfzq]=cdfest(z,w);end;qgauss=gaussinv(cdfzq,[0 1]);if nargout==0,  plot(zq,qgauss,'o');  xlabel('Values');  ylabel('Gaussian quantiles');end;