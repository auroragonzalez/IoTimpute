function [zfile,cdfzfile]=cdfest(z,w);% cdfest                    - experimental cumulative distribution (Jan 1,2001)%% Compute an estimate of the univariate cumulative distribution% function from a set of values for a variable. The theoretical% definition of this distribution is F(z)=P[Z<=z]. As the% distribution is computed from a discrete set of values, a% continuity correction is done such that the estimate Fest(z)=% (Pest[Z<=z]+Pest[Z<z])/2, where Pest(.) are probabilities% estimated from the frequencies.%% SYNTAX :%% [zfile,cdfzfile]=cdfest(z,w);%% INPUT :%% z         n by 1   vector of values.% w         n by 1   optional column vector of weights for the z values.%                    These weights must be positive and must sum to one%                    (see, e.g., decluster.m above). If w is not specified,%                    all the weights are taken as equal.%% OUPUT :%% zfile     m by 1   vector of z values sorted in ascending order, where%                    the duplicate z values have been removed. If there%                    are no duplicate values, zfile is simply the sorted%                    z vector (m<=n).% cdfzfile  m by 1   vector of estimated values of the cumulative%                    distribution function computed at the zfile values.n=length(z);if nargin<2,  w=ones(n,1)/n;end;[z,index]=sort(z);w=w(index);i=1;                       %%% delete the duplicate valueswhile i<n,  if z(i+1)==z(i),    w(i+1)=w(i+1)+w(i);    z(i)=[];    w(i)=[];    n=n-1;  else     i=i+1;  end;end;w=[0;w];cdfzfile=cumsum(0.5*w(1:n)+0.5*w(2:n+1));zfile=z;