function [z]=loggaussinv(p,param);% loggaussinv               - inverse log-Gaussian cumulative distribution function (Jan 1,2001)%% Compute the quantiles for a log-Gaussian distribution with% specified mean and variance parameters for the associated% Gaussian distribution.%% SYNTAX :%% [z]=loggaussinv(p,param);%% INPUT :%% p        n by k   matrix of values for the cumulative probabilities.% param    1 by 2   parameters of the Gaussian distribution, where :%                   param(1) is the mean of the distribution,%                   param(2) is the variance of the distribution.%% OUTPUT :%% z        n by k   matrix of quantile values computed at the%                   corresponding p values.%% NOTE :%% For values of p equal to 1, the function returns the values% exp(param(1)+8.3*sqrt(param(2))) instead of the +Inf value% (see gaussinv.m).m=param(1);v=param(2);if v<0,  error('a variance cannot be negative');end;if max(p(:))>1 | min(p(:))<0,  error('cumulative probability values must be inside [0,1]');end;z=sqrt(2)*erfinv(2*p-1);findisinf=find(isinf(z));signisinf=sign(z(findisinf));z(findisinf)=signisinf*8.3;z=z*sqrt(v)+m;z=exp(z);if ~isempty(signisinf),  z(findisinf(signisinf==-1))=0;end;