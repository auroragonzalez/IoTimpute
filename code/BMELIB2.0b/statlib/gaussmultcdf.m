function [cdf]=gaussmultcdf(z,m,C,options);% gaussmultcdf              - multivariate Gaussian cumulative distribution function (Jan 1,2001)%% Compute the value of the multivariate Gaussian cumulative% distribution functions for a vector of values for these% variables. The gaussmultcdf.m function uses a FORTRAN77% subroutine for evaluating the corresponding multiple integrals.%% SYNTAX :%% [cdf]=gaussmultcdf(z,m,C,options);%% INPUT :%% z        n by 1   vector of values for the Gaussian distributed variables.% m        n by 1   vector of means for the variables.% C        n by n   symmetric covariance matrix for the variables.% options  1 by 2   vector of optional parameters that can be used if default%                   values are not satisfactory (otherwise this vector can simply%                   be omitted from the input list of variables), where :%                   options(1) is the maximum number of evaluations for the integral%                              (default value is 50000),%                   options(2) is the relative error on the estimation of the integral%                              (default value is 1e-4).%% OUTPUT :%% cdf      scalar   value of the cumulative distribution function computed%                   for the z vector of values.if nargin<4,  options(1)=50000;  options(2)=1e-4;end;D=diag(diag(C));z=(z-m)./sqrt(diag(D));C=(D^-0.5)*C*(D^-0.5);n=length(z);unit=ones(n,1);cdf=mvnAG1(-15*unit,z,C,options(1),0,options(2));