function [cdf]=pdf2cdf(z,pdf);% pdf2cdf                   - compute the cdf from the pdf (Jan 1,2001)%% Computes the values of the cumulative distribution function% based on a discrete definition of the corresponding probability% distribution function. The integration of the probability% distribution function is realized using a trapezoidal integration% formula. %% SYNTAX :%% [cdf]=pdf2cdf(z,pdf);%% INPUT :%% z      n by 1   vector of values.% pdf    n by 1   vector of the probability distribution function values%                 at the z values.%% OUPUT :%          % cdf    n by 1   vector of the cumulative distribution function values%                 at the z values.%% NOTE :%% As the routine uses a trapezoidal integration scheme, it is recommended% to have a finely discretized definition of the probability distribution% function, with values that are equal to or close to zero for the lowest% z values, so that the neglected probability below the lowest value in z% is null or close to zero. The value of the cumulative distribution% function at the lowest z value is set equal to half the value of the% cumulative distribution function at the following z value.n=length(z);[z,index1]=sort(z);           %%% Keep track of the rank for the sorted valuespdf=pdf(index1);              %%% sort the pdf values accordinglydz=diff(z);                   %%% Compute the z incrementspdf=(pdf(1:n-1)+pdf(2:n))/2;cdf=cumsum(dz.*pdf);          %%% Integrates using trapezoidal formulacdf=[cdf(1)/2;cdf];           %%% Add first value taken as half of the second onemaxcdf=max(cdf);              %%% Check if the maximum cdf value>1if maxcdf>1,                  %%% and reset the cdf values if so    cdf=cdf/maxcdf;end;[index1,index2]=sort(index1); %%% Resort the values in the original ordercdf=cdf(index2);