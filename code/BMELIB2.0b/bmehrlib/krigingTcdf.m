function [cdf]=krigingTcdf(y,ck,ch,yh,covmodel,covparam,nhmax,dmax,yfile,cdfyfile);% krigingTcdf               - prediction using kriging methods with transformation (Jan 1,2001)%% Provide an estimate of the cumulative distribution function% when data cannot reasonably be assumed as Gaussian distributed.% This function is closely related to krigingT.m, but it estimates% the complete distribution on the original scale, instead of% merely the expectation and the variance of this distribution. %% SYNTAX :%% [cdf]=krigingTcdf(y,ck,ch,yh,covmodel,covparam,nhmax,dmax,yfile,cdfyfile);%% INPUT :%% y         nz by 1   vector of values sorted in ascending order for which%                     the distribution must be computed. It is recommended%                     to have a finely discretized set of values, so that%                     the distribution can be computed on a fine scale.% ck        1  by d   line vector of coordinates for the estimation%                     location, where d is the dimension of the space. For%                     doing computation at different estimation locations,%                     the function can be invoked in a loop so that a new ck%                     vector can be used.% ch        nh by d   matrix of coordinates for the hard data locations,%                     with the same convention as for ck.% yh        nh by 1   vector of the values on the original (non-Gaussian)%                     scale for the hard data at the coordinates specified%                     in ch.% covmodel  string    that contains the name of the covariance model that is%                     used for estimation on the Gaussian scale (see the%                     MODELS directory). Variogram models can not be used with%                     this function. If this model has to be estimated from%                     the data, it is needed to transform the data on the%                     Gaussian scale prior to its estimation (see other2gauss.m). % covparam  1 by k    vector of values for the parameters of covmodel that are%                     defined on the Gaussian scale, according to the convention%                     for the corresponding covariance model. % nhmax     scalar    maximum number of hard data values that are considered%                     for the estimation at the locations specified in ck.% dmax      scalar    maximum distance between an estimation location and%                     existing hard data locations. All hard data locations%                     separated by a distance smaller than dmax from an%                     estimation location will be included in the estimation%                     process for that location, whereas other hard data%                     locations are neglected.% yfile     m by 1    vector of values sorted in ascending order for which the%                     cumulative distribution distribution is provided on the%                     original scale. It is recommended to have a finely%                     discretized set of values, so computations can be realized%                     on a fine scale.% cdfyfile  m by 1    vector of values for the cumulative distribution function%                     at the yfile values.%% OUTPUT :%% cdf       nz by 1   vector of values for the cumulative distribution function%                     computed at the y values. The values of the distribution%                     associated with y values that are outside the range of yfile%                     are coded as NaN's.%% NOTE :%% 1- Using krigingTcdf.m requires that the variable has a constant mean.% If this hypothesis does not hold, it is necessary to remove first the% values of the mean from the yh vector. This can be done using, e.g., the% regression.m or the kernelregression.m functions.%% 2- Using the cdf2pdf.m function, it is possible to get an estimate of the% probability distribution function. This allows the user to compute several% statistics like the mean, the variance or various quantiles (see the% pdfstat.m and quantile.m functions in the STATISTICS directory).%% 3- If there are several variables to be processed at the same time (see% the multivariate case described in kriging.m above), the yfile and% cdfyfile variables must be defined as 1 by nv cell arrays, where each cell% corresponds to the definition of the distribution for the corresponding% variable. For the other variables, all the specific conventions are the% same as for kriging.m.noindex=~iscell(ck);if noindex==1,  z=other2gauss(y,yfile,cdfyfile);  zh=other2gauss(yh,yfile,cdfyfile);  yfile={yfile};  cdfyfile={cdfyfile};  indexk=1;else  indexk=ck{2};  indexh=ch{2};  z=other2gauss({y,indexk},yfile,cdfyfile);  zh=other2gauss({yh,indexh},yfile,cdfyfile);end;[zk,vk]=kriging(ck,ch,zh,covmodel,covparam,nhmax,dmax,NaN);if vk==0,  cdf=zeros(size(y));  yk=gauss2other(zk,yfile{indexk},cdfyfile{indexk});  cdf(y>=yk)=1;else  cdf=gausscdf(z,[zk,vk]);end;