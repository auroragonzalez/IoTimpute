function [pdf]=krigingPdfk(z,ck,ch,zh,model,param,nhmax,dmax,order,pdfmodel,pdfparam);% krigingPdfk               - kriging pdf prediction with soft pdf at estimation point (Jan 1,2001)%% Implementation of kriging  hard and soft data, where the% soft data are available at the estimation locations. This% is typically the case where there is an exhaustive soft% information available over the area. Based solely on the% hard data locations and using a linear kriging algorithm,% the kriging estimates can be obtained at the estimation% locations. Afterward, a simple Bayesian updating rule can% be used to incorporate the probabilistic soft data at the% estimation locations. E.g., using a uniform probability% distribution function at an estimation location is an% elegant way of including the constraint that the estimated% values must lie in the corresponding interval. %% SYNTAX :%% [pdf]=krigingPdfk(z,ck,ch,zh,model,param,nhmax,dmax,order,pdfmodel,pdfparam);%% INPUT :%% z         nz by 1        vector of values sorted in ascending order for which%                          the distribution must be computed. It is recommended%                          to have a finely discretized set of values, so that%                          the distribution can be computed on a fine scale.% ck        1  by d        vector of coordinates for the estimation location,%                          where d is the dimension of the space. For doing%                          computation at different estimation locations, the%                          function can be invoked in a loop so that a new ck%                          vector and probabilistic soft data can be used.% ch        nh by d        matrix of coordinates for the hard data locations,%                          with the same convention as for ck.% zh        nh by 1        vector of values for the hard data at the coordinates%                          specified in ch.% model     string         that contains the name of the variogram or covariance%                          model that is used for the estimation (see the MODELS%                          directory). % param     1 by k         vector of values for the parameters of model, according%                          to the convention for the corresponding variogram or %                          covariance model.% nhmax     scalar         maximum number of hard data values that are considered%                          for the estimation at the locations specified in ck.% dmax      scalar         maximum distance between an estimation location and%                          existing hard data locations. All hard data locations%                          separated by a distance smaller than dmax from an%                          estimation location will be included in the estimation%                          process for that location, whereas other hard data%                          locations are neglected.% order     scalar         order of the polynomial mean along the spatial axes at%                          the estimation locations. For the zero-mean case, NaN%                          (Not-a-Number) is used. Note that order=NaN can only be%                          used with covariance models and not with variogram models.% pdfmodel  string/nz by 1 that contains the name of the probabilistic soft data at%                          the estimation location or a set of discretized values for%                          the probability distribution function  at the z values%                          (see the *pdf.m functions in the STATISTICS directory for%                          valid names of distributions).% pdfparam  1 by k         vector of parameters for the pdfmodel distribution. This%                          input variable must not to be specified if pdfmodel is not%                          a string but a vector of values that define the distribution.%% OUTPUT :%% pdf       nz by 1        vector of values for the probability distribution function%                          computed at the z values.%% NOTE :%% 1- For example, if the probabilistic soft data at the estimation% location is Gaussian distributed with mean and variance equal to% 0.5 and 1.2, respectively, the input are pdfmodel='gausspdf' and% pdfparam=[0.5,1.2]. Alternatively, it is possible to compute the% values of this Gaussian distribution at the z values using pdfmodel% =gausspdf(z,[0.5,1.2]),and pdfparam must not be specified anymore.% This method allows the user to use some of the most common% distributions that have been included in this package (see the % *.pdf.m functions), or a customized non parametric distribution.%% 2- If there are several variables to be processed at the same time% (see the multivariate case described in kriging.m above), the% pdfmodel and pdfparam variables can alternatively (but not% necessarily) be defined as 1 by nv cell arrays, where each cell% corresponds to the definition of the probabilistic soft data% distribution for the corresponding variable. This coding can be% useful if the function must be used for estimating different% variables ; the user does not have to provide as input variable% the probabilistic soft data distribution which is specific for the% variable to be estimated, as the function will automatically do the% appropriate selection. For the other variables, all the specific% conventions are the same as for kriging.m.%% 3- As this function computes the complete distribution at the% estimation location, it is possible to compute afterward several% statistics like the mean, the variance or various quantiles from it% (see the pdfstat.m and quantile.m functions).[zk,vk]=kriging(ck,ch,zh,model,param,nhmax,dmax,order);pdfkrig=gausspdf(z,[zk vk]);noindex=(iscell(ck)==0);if nargin<11,  if (noindex==0)&&(iscell(pdfmodel)),    index=ck{2};    pdfmodel=pdfmodel{index};      end;  [pdf]=pdfprod(z,pdfkrig,pdfmodel);else  if (noindex==0)&&(iscell(pdfmodel)),    index=ck{2};    pdfmodel=pdfmodel{index};    pdfparam=pdfparam{index};  end;  [pdf]=pdfprod(z,pdfkrig,pdfmodel,pdfparam);end;