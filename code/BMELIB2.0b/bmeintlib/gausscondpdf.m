function [pdf1if2]=gausscondpdf(z1,a2,b2,m,K,options);% gausscondpdf              - conditional gaussian pdf for intervals (Jan 1,2001)%% Compute the univariate conditional Gaussian probability distribution% function from a multivariate Gaussian probability distribution function.% The conditioning variables are intervals of values.%% SYNTAX :%% [pdf1if2]=gausscondpdf(z1,a2,b2,m,K,options);%% INPUT :%% z1         n by 1    vector of values for the univariate conditional%                      distribution of z1 given z2.% a2         n-1 by 1  vector of lower bounds of the intervals for the%                      vector of conditioning variables z2.% b2         n-1 by 1  vector of upper bounds of the intervals for the%                      vector of conditioning variables z2.% m          n by 1    vector of mean for the [z1,z2] vector of variables% K          n by n    covariance matrix for the [z1,z2] vector of variables%                      where K=[[K11 K12];[K21 K22]];% options    1 by 4    vector of optional parameters, where :%                      options(3) is the maximum number of evaluation of the%                      integral (default value is 50000).%                      options(4) is the relative error on the estimation of%                      the integral (default value is 1e-4).%                      The other values of options are not used.%% OUTPUT :%% pdf1if2    n by 1    vector of the conditional probability distribution at%                      the values specified in z1, given the [a2,b2] intervals%                      for the z2 variables.if nargin<6,  options(3)=50000;  options(4)=1e-4;end;nz=size(z1,1);n=size(m,1);pdf=zeros(nz,1);z1=z1-m(1);a2=a2-m(2:n);a2=a2-m(2:n);K11=K(1,1);K22=K(2:n,2:n);K12=K(1,2:n);pdf1if2=zeros(nz,1);[fden]=intBMEinterval([],a2,b2,[],K22,options);if fden~=0,  cstnum=1/(((2*pi)^0.5)*sqrt(K11));  invK22=inv(K22);  K12invK22=K12*invK22;  for i=1:nz,    [Pnum]=intBMEinterval(z1(i),a2,b2,K12invK22,K11-K12invK22*K12',options);    fnum=cstnum*exp(-0.5*z1(i)*z1(i)/K11)*Pnum;    pdf1if2(i)=fnum/fden;  end;end;z1=z1+m(1);